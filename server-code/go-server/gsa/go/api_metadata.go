/*
 * Discovery Market Research
 *
 * <p>This API drives the <a href=\"https://discovery.gsa.gov\">Discovery Market Research Tool</a>. It contains information on the vendors that are part of the OASIS and OASIS Small Business contracting vehicles, such as their contracting history, their elligibility for contract awards, and their small business designations. To learn more about the tool, please visit <a href=\"https://discovery.gsa.gov\">Discovery</a> or see the README on our <a href=\"https://github.com/PSHCDevOps/discovery\">GitHub repository</a>.</p> <p><strong>Please note that the base path for this API is <code>https://api.data.gov/gsa/discovery/</code></strong></p> <p>It requires an API key, obtainable at <a href=\"http://api.data.gov/\">api.data.gov</a>. It must be passed in the <code>api_key</code> parameter with each request.</p>
 *
 * API version: 0.1
 * Contact: discovery-18f@gsa.gov
 * Generated by: OpenAPI Generator (https://openapi-generator.tech)
 */

package openapi

import (
	"encoding/json"
	"net/http"
	"strings"

	"github.com/gorilla/mux"
)

// MetadataAPIController binds http requests to an api service and writes the service results to the http response
type MetadataAPIController struct {
	service MetadataAPIServicer
	errorHandler ErrorHandler
}

// MetadataAPIOption for how the controller is set up.
type MetadataAPIOption func(*MetadataAPIController)

// WithMetadataAPIErrorHandler inject ErrorHandler into controller
func WithMetadataAPIErrorHandler(h ErrorHandler) MetadataAPIOption {
	return func(c *MetadataAPIController) {
		c.errorHandler = h
	}
}

// NewMetadataAPIController creates a default api controller
func NewMetadataAPIController(s MetadataAPIServicer, opts ...MetadataAPIOption) Router {
	controller := &MetadataAPIController{
		service:      s,
		errorHandler: DefaultErrorHandler,
	}

	for _, opt := range opts {
		opt(controller)
	}

	return controller
}

// Routes returns all the api routes for the MetadataAPIController
func (c *MetadataAPIController) Routes() Routes {
	return Routes{
		"MetadataGET": Route{
			strings.ToUpper("Get"),
			"/api/metadata/",
			c.MetadataGET,
		},
	}
}

// MetadataGET - This endpoint returns metadata for the most recent data loads of SAM and FPDS data
func (c *MetadataAPIController) MetadataGET(w http.ResponseWriter, r *http.Request) {
	result, err := c.service.MetadataGET(r.Context())
	// If an error occurred, encode the error with the status code
	if err != nil {
		c.errorHandler(w, r, err, &result)
		return
	}
	// If no error, encode the body and the result code
	EncodeJSONResponse(result.Body, &result.Code, w)
}
